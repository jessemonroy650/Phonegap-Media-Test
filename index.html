<!DOCTYPE html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>PhoneGap Media Test</title>
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="buttons.css" />
    <style>
    body {margin:0px;}
    .hidden {visibility:collapse;display:none;}
    .expose {visibility:visible;display:block;} /* Here for completeness only. */
    .copyright {padding:5px;align:left;font-style:italic;font-size:small;}
    #header {margin:0;padding:0;}
    #exitApp {margin:0.1em;float:right;}
    </style>
    <!-- do not modify HTML until after BODY is loaded -->
    <script type="application/javascript" src="fastclick.js"></script>
    <script type="text/javascript" src="cordova.js"></script>
</head>
<body>
<div id=header class="button button-block button-large">
    <img align=left src=favicon-48x48.png>
    Phonegap Media Test
</div>
<div id=theBody>
    <b>Status:</b> <span id="status">BIG ERROR</span>
    <p>
    <button id=exitApp onclick='navigator.app.exitApp()' class="button button-pill button-primary button-large">Exit</button>
    </p>
</div>

<div class="copyright" style="padding:5px;align:left;font-style:italic;font-size:small;">
    <span id=copyright>Created by Jesus Monroy, Jr. &copy; 2018-09-15c</span>
</div>
</body>
    <script type="text/javascript">
    function onSuccess() {
        document.getElementById('status').textContent = "found file";
    };
    function onError(e) {
        alert('err.code:' + e.code + '\nerr.message:' + e.message)
    };
    var my_media = null;
    var mediaTimer = null;
    // Thanks Raymond ;-) - https://www.raymondcamden.com/2014/06/23/Cordova-Media-API-Example
    function getMediaURL(s) {
        if(device.platform.toLowerCase() === "android") return "/android_asset/www/" + s;
        return s;
    }
    function onDeviceReady() {
        var audioFile = "";
        //alert("onDeviceReady");
        document.getElementById('status').textContent = "onDeviceReady";

        // Get rid of 300ms delay 
        document.addEventListener('DOMContentLoaded', function() { FastClick.attach(document.body); }, false);

        // Android get the audio file given a FQFN (Fully Qualified File Name)
        audioFile = getMediaURL("fanfare3.ogg");
        document.getElementById('status').textContent = audioFile;

        // Check for the file. 
        // https://www.raymondcamden.com/2014/07/01/Cordova-Sample-Check-for-a-file-and-download-if-it-isnt-there/
        window.resolveLocalFileSystemURL(audioFile, onSuccess, onError);
        document.getElementById('status').textContent = "Found file";

        // Don't do much with this right now. Just play it.
        my_media = new Media(audioFile, onSuccess, onError);
        document.getElementById('status').textContent = "audio loaded -> " + audioFile;

        // The 'numberOfLoops' is iOS only.
        my_media.play();
        //alert("audio playing");
        document.getElementById('status').textContent = "audio playing -> " + audioFile;
    }
    // Wait for PhoneGap to load
    document.addEventListener("deviceready", onDeviceReady, false);
    document.getElementById('status').textContent = "init js block loaded";
    </script>

</html>
